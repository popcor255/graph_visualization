var htmlCanvas,ctx,win_l,win_h,size,radius,vectors,mousePos,blue="#5a8ded",red="#d61d45",white="#f3f7f3";function main(){htmlCanvas=document.getElementById("myCanvas"),ctx=htmlCanvas.getContext("2d"),vectors=[],mousePos=[],win_l=.96*window.innerWidth,win_h=.96*window.innerHeight,size=Math.min(win_h,win_l),radius=size/70,ctx.canvas.width=size,ctx.canvas.height=size,htmlCanvas.addEventListener("mousedown",function(e){mousePos=[e.x,e.y]},!1),htmlCanvas.addEventListener("mouseup",function(e){1===e.which&&isEqual(mousePos,[e.x,e.y])&&ctxEvent(),mousePos=[e.x,e.y]},!1),htmlCanvas.addEventListener("wheel",function(e){scrollEvent(e)},!1)}function ctxEvent(){nodeEventHandler(htmlCanvas.relMouseCoords(event),radius,!1,null)}function scrollEvent(e){var t=0,i=e.deltaY;0<vectors.length&&(i<0&&size/65<=radius&&(console.log("down"),t=-2),0<i&&radius<=size/60&&(console.log("up"),t=2)),radius+=t;for(var n=0;n<vectors.length;n++)temp=vectors[n],vectors[n].clearRegion(),vectors[n]=new Node(temp.x,temp.y,radius,temp.fill,1,n),vectors[n].draw()}function nodeEventHandler(e,t,i,n){if(e.x>t&&e.x<size-t&&e.y>t&&e.y<size-t){for(var o=0;o<vectors.length;o++)null!=(n=vectors[o])&&n.isClicked(e.x,e.y)&&(n.clearRegion(),vectors.splice(o,1),i=!0);0==i&&((n=new Node(e.x,e.y,t,white,1,vectors.length-1)).isCollision(vectors)||vectors.push(n))}0<vectors.length&&((n=vectors[0]).clearRegion(),vectors[0]=new Node(n.x,n.y,n.r,blue,1,0),vectors[0].draw());for(o=1;o<vectors.length-1;o++)n=vectors[o],vectors[o].clearRegion(),vectors[o]=new Node(n.x,n.y,n.r,white,1,o),vectors[o].draw();1<vectors.length&&((n=vectors[vectors.length-1]).clearRegion(),vectors[vectors.length-1]=new Node(n.x,n.y,n.r,red,1,vectors.length-1),vectors[vectors.length-1].draw())}function Edge(e,t){this.head=e,this.tail=t,this.draw=function(){ctx.beginPath(),ctx.globalCompositeOperation="destination-over",ctx.moveTo(e.x,e.y),ctx.lineTo(t.x,t.y),ctx.stroke(),ctx.globalCompositeOperation="source-over"}}function Node(s,r,n,e,t,i){this.startingAngle=0,this.endAngle=2*Math.PI,this.x=s,this.y=r,this.r=n,this.region=size/60*2.2,this.index=i,this.fill=e,this.stroke=t,this.draw=function(){ctx.beginPath(),ctx.arc(this.x,this.y,this.r,this.startingAngle,this.endAngle),ctx.fillStyle=this.fill,ctx.lineWidth=3,ctx.fill(),ctx.strokeStyle=this.stroke,ctx.stroke(),size/60<=n&&(ctx.font="8pt Calibri",ctx.fillStyle="black",ctx.textAlign="center",ctx.fillText(i,this.x,this.y+3))},this.clearRegion=function(){ctx.clearRect(this.x-this.region/2,this.y-this.region/2,this.region,this.region)},this.isClicked=function(e,t){var i=!1;return s-n<e&&e<s+n&&r-n<t&&t<r+n&&(i=!0),i},this.isCollision=function(e){for(var t=!1,i=0;i<e.length;i++)if(null!=e[i]){var n=e[i].x,o=e[i].y;n>s-this.region&&n<s+this.region&&o>r-this.region&&o<r+this.region&&(t=!0)}return t}}function relMouseCoords(e){for(var t=0,i=0,n=this;t+=n.offsetLeft-n.scrollLeft,i+=n.offsetTop-n.scrollTop,n=n.offsetParent;);return{x:e.pageX-t,y:e.pageY-i}}function isEqual(e,t){for(var i=Math.min(e.length,t.length),n=!0,o=0;o<i;o++)e[o]!=t[o]&&(n=!1);return n}HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords,CanvasRenderingContext2D.prototype.clear=function(){ctx.clearRect(0,0,size,size),vectors=[]};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaHRtbENhbnZhcyIsImN0eCIsIndpbl9sIiwid2luX2giLCJzaXplIiwicmFkaXVzIiwidmVjdG9ycyIsIm1vdXNlUG9zIiwiYmx1ZSIsInJlZCIsIndoaXRlIiwibWFpbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiTWF0aCIsIm1pbiIsImNhbnZhcyIsIndpZHRoIiwiaGVpZ2h0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2IiwieCIsInkiLCJ3aGljaCIsImlzRXF1YWwiLCJjdHhFdmVudCIsInNjcm9sbEV2ZW50Iiwibm9kZUV2ZW50SGFuZGxlciIsInJlbE1vdXNlQ29vcmRzIiwiZXZlbnQiLCJzY3JvbGwiLCJkZWx0YVkiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwiaSIsInRlbXAiLCJjbGVhclJlZ2lvbiIsIk5vZGUiLCJmaWxsIiwiZHJhdyIsImNvb3JkcyIsInJlbW92ZWQiLCJpc0NsaWNrZWQiLCJzcGxpY2UiLCJpc0NvbGxpc2lvbiIsInB1c2giLCJyIiwiRWRnZSIsImhlYWQiLCJ0YWlsIiwidGhpcyIsImJlZ2luUGF0aCIsImdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiIsIm1vdmVUbyIsImxpbmVUbyIsInN0cm9rZSIsImluZGV4Iiwic3RhcnRpbmdBbmdsZSIsImVuZEFuZ2xlIiwiUEkiLCJyZWdpb24iLCJhcmMiLCJmaWxsU3R5bGUiLCJsaW5lV2lkdGgiLCJzdHJva2VTdHlsZSIsImZvbnQiLCJ0ZXh0QWxpZ24iLCJmaWxsVGV4dCIsImNsZWFyUmVjdCIsImluX3giLCJpbl95IiwiY2xpY2tlZCIsImFyciIsInRvdGFsT2Zmc2V0WCIsInRvdGFsT2Zmc2V0WSIsImN1cnJlbnRFbGVtZW50Iiwib2Zmc2V0TGVmdCIsInNjcm9sbExlZnQiLCJvZmZzZXRUb3AiLCJzY3JvbGxUb3AiLCJvZmZzZXRQYXJlbnQiLCJwYWdlWCIsInBhZ2VZIiwiYSIsImIiLCJyZXN1bHQiLCJIVE1MQ2FudmFzRWxlbWVudCIsInByb3RvdHlwZSIsIkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCIsImNsZWFyIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUNBQyxJQUNBQyxNQUNBQyxNQUNBQyxLQUNBQyxPQUNBQyxRQUNBQyxTQUVBQyxLQUFPLFVBQ1BDLElBQU0sVUFDTkMsTUFBUSxVQUVaLFNBQVNDLE9BQ0xYLFdBQWFZLFNBQVNDLGVBQWUsWUFDckNaLElBQU1ELFdBQVdjLFdBQVcsTUFDNUJSLFFBQVUsR0FDVkMsU0FBVyxHQUNYTCxNQUE0QixJQUFwQmEsT0FBT0MsV0FDZmIsTUFBNkIsSUFBckJZLE9BQU9FLFlBQ2ZiLEtBQU9jLEtBQUtDLElBQUloQixNQUFPRCxPQUN2QkcsT0FBU0QsS0FBTyxHQUNoQkgsSUFBSW1CLE9BQU9DLE1BQVNqQixLQUNwQkgsSUFBSW1CLE9BQU9FLE9BQVNsQixLQUVwQkosV0FBV3VCLGlCQUFpQixZQUFjLFNBQVNDLEdBQy9DakIsU0FBVyxDQUFDaUIsRUFBR0MsRUFBR0QsRUFBR0UsS0FDdEIsR0FHSDFCLFdBQVd1QixpQkFBaUIsVUFBWSxTQUFTQyxHQUM1QixJQUFiQSxFQUFHRyxPQUFlQyxRQUFRckIsU0FBVSxDQUFDaUIsRUFBR0MsRUFBSUQsRUFBR0UsS0FDL0NHLFdBR0p0QixTQUFXLENBQUNpQixFQUFHQyxFQUFHRCxFQUFHRSxLQUN0QixHQUdIMUIsV0FBV3VCLGlCQUFpQixRQUFTLFNBQVNDLEdBQzFDTSxZQUFZTixLQUNiLEdBR1AsU0FBU0ssV0FLTEUsaUJBSmEvQixXQUFXZ0MsZUFBZUMsT0FJZDVCLFFBSFgsRUFDSCxNQU1mLFNBQVN5QixZQUFZTixHQUNqQixJQUFJVSxFQUFTLEVBQ1RSLEVBQUlGLEVBQUdXLE9BRVMsRUFBakI3QixRQUFROEIsU0FDSFYsRUFBSSxHQUFnQnRCLEtBQU8sSUFBbEJDLFNBQ1RnQyxRQUFRQyxJQUFJLFFBQ1pKLEdBQVUsR0FHTixF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ZUMsV0FBYUQsRUFBZUUsV0FDM0RILEdBQWdCQyxFQUFlRyxVQUFZSCxFQUFlSSxVQUV4REosRUFBaUJBLEVBQWVLLGVBS3RDLE1BQU8sQ0FBQzVELEVBSEVRLEVBQU1xRCxNQUFRUixFQUdMcEQsRUFGVE8sRUFBTXNELE1BQVFSLEdBSzVCLFNBQVNuRCxRQUFRNEQsRUFBR0MsR0FJaEIsSUFIQSxJQUFJckYsRUFBT2MsS0FBS0MsSUFBSXFFLEVBQUVwRCxPQUFRcUQsRUFBRXJELFFBQzVCc0QsR0FBUyxFQUVMbkQsRUFBSSxFQUFHQSxFQUFJbkMsRUFBTW1DLElBQ2xCaUQsRUFBRWpELElBQU1rRCxFQUFFbEQsS0FDVG1ELEdBQVMsR0FJakIsT0FBT0EsRUFHWEMsa0JBQWtCQyxVQUFVNUQsZUFBaUJBLGVBRTdDNkQseUJBQXlCRCxVQUFVRSxNQUFRLFdBQ3ZDN0YsSUFBSXdFLFVBQVUsRUFBRSxFQUFFckUsS0FBS0EsTUFDdkJFLFFBQVUiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGh0bWxDYW52YXM7XG52YXIgY3R4O1xudmFyIHdpbl9sO1xudmFyIHdpbl9oO1xudmFyIHNpemU7XG52YXIgcmFkaXVzO1xudmFyIHZlY3RvcnM7XG52YXIgbW91c2VQb3M7XG5cbnZhciBibHVlID0gXCIjNWE4ZGVkXCI7XG52YXIgcmVkID0gXCIjZDYxZDQ1XCI7XG52YXIgd2hpdGUgPSBcIiNmM2Y3ZjNcIjtcblxuZnVuY3Rpb24gbWFpbigpIHtcbiAgICBodG1sQ2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhbnZhc1wiKTtcbiAgICBjdHggPSBodG1sQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgdmVjdG9ycyA9IFtdO1xuICAgIG1vdXNlUG9zID0gW107XG4gICAgd2luX2wgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuOTY7XG4gICAgd2luX2ggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjk2O1xuICAgIHNpemUgPSBNYXRoLm1pbih3aW5faCwgd2luX2wpO1xuICAgIHJhZGl1cyA9IHNpemUgLyA3MDtcbiAgICBjdHguY2FudmFzLndpZHRoICA9IHNpemU7XG4gICAgY3R4LmNhbnZhcy5oZWlnaHQgPSBzaXplO1xuXG4gICAgaHRtbENhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICBmdW5jdGlvbihldikge1xuICAgICAgICBtb3VzZVBvcyA9IFtldi54LCBldi55XTtcbiAgICB9LCBmYWxzZSk7XG5cblxuICAgIGh0bWxDYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGlmIChldi53aGljaCA9PT0gMSAmJiBpc0VxdWFsKG1vdXNlUG9zLCBbZXYueCAsIGV2LnldKSkge1xuICAgICAgICAgICAgY3R4RXZlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbW91c2VQb3MgPSBbZXYueCwgZXYueV07XG4gICAgfSwgZmFsc2UpO1xuXG5cbiAgICBodG1sQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgc2Nyb2xsRXZlbnQoZXYpO1xuICAgIH0sIGZhbHNlKTtcbn1cblxuZnVuY3Rpb24gY3R4RXZlbnQoKXtcbiAgICB2YXIgY29vcmRzID0gaHRtbENhbnZhcy5yZWxNb3VzZUNvb3JkcyhldmVudCk7XG4gICAgdmFyIHJlbW92ZWQgPSBmYWxzZTtcbiAgICB2YXIgdGVtcCA9IG51bGw7XG5cbiAgICBub2RlRXZlbnRIYW5kbGVyKGNvb3JkcywgcmFkaXVzLCByZW1vdmVkLCB0ZW1wKTtcbiAgICBcbn1cblxuZnVuY3Rpb24gc2Nyb2xsRXZlbnQoZXYpe1xuICAgIHZhciBzY3JvbGwgPSAwO1xuICAgIHZhciB5ID0gZXYuZGVsdGFZO1xuXG4gICAgaWYodmVjdG9ycy5sZW5ndGggPiAwKXtcbiAgICAgICAgaWYgKHkgPCAwICYmIHJhZGl1cyA+PSAoc2l6ZSAvIDY1KSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJkb3duXCIpO1xuICAgICAgICAgICAgc2Nyb2xsID0gLTI7ICAgXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoeSA+IDAgJiYgcmFkaXVzIDw9IChzaXplIC8gNjApKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwXCIpO1xuICAgICAgICAgICAgc2Nyb2xsID0gMjsgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJhZGl1cyArPSBzY3JvbGw7XG5cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdmVjdG9ycy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHRlbXAgPSB2ZWN0b3JzW2ldO1xuICAgICAgICB2ZWN0b3JzW2ldLmNsZWFyUmVnaW9uKCk7XG4gICAgICAgIHZlY3RvcnNbaV0gPSBuZXcgTm9kZSh0ZW1wLngsIHRlbXAueSwgcmFkaXVzLCB0ZW1wLmZpbGwsIDEsIGkpO1xuICAgICAgICB2ZWN0b3JzW2ldLmRyYXcoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vZGVFdmVudEhhbmRsZXIoY29vcmRzLCByYWRpdXMsIHJlbW92ZWQsIHRlbXApe1xuXG4gICAgLy9UaGUgY29uZGl0aW9ucyBnbyBhcyBmb2xsb3dzOlxuICAgIC8vMSkgVGhlIGNpcmNsZSBtdXN0IGZpdCBpbiB0aGUgY2FudmFzIChsaW5lcyA0Mi00MylcbiAgICAvLzIpIFRoZSBjaXJjbGUgbXVzdCBub3Qgb3ZlcmxhcCAobGluZXMgNDcpXG4gICAgLy8zKSBJZiB0aGUgY2lyY2xlIGlzIGFscmVhZHkgcHJlc2VudCBkbyBub3QgYWRkLCBidXQgcmVtb3ZlXG5cbiAgICBpZihjb29yZHMueCA+IHJhZGl1cyAmJiBjb29yZHMueCA8IHNpemUgLSByYWRpdXMpe1xuICAgICAgICBpZihjb29yZHMueSA+IHJhZGl1cyAmJiBjb29yZHMueSA8IHNpemUgLSByYWRpdXMpe1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHZlY3RvcnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIHRlbXAgPSB2ZWN0b3JzW2ldO1xuICAgICAgICAgICAgICAgIGlmKHRlbXAgIT0gbnVsbCAmJiB0ZW1wLmlzQ2xpY2tlZChjb29yZHMueCwgY29vcmRzLnkpKXtcbiAgICAgICAgICAgICAgICAgICAgdGVtcC5jbGVhclJlZ2lvbigpO1xuICAgICAgICAgICAgICAgICAgICB2ZWN0b3JzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihyZW1vdmVkID09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICB0ZW1wID0gbmV3IE5vZGUoY29vcmRzLngsIGNvb3Jkcy55LCByYWRpdXMsIHdoaXRlLCAxLCB2ZWN0b3JzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIGlmKCF0ZW1wLmlzQ29sbGlzaW9uKHZlY3RvcnMpKXtcbiAgICAgICAgICAgICAgICAgICAgdmVjdG9ycy5wdXNoKHRlbXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vcmVkcmF3IG5vZGVzIGFzIGZvbGxvd3NcbiAgICAvL2lmIHRoZSBoZWFkIHlvdXIgYmx1ZVxuICAgIC8vaWYgdGhlIHRhaWwgeW91ciByZWRcbiAgICAvL2Vsc2UgeW91ciBncmVlblxuXG4gICAgaWYodmVjdG9ycy5sZW5ndGggPiAwKXtcbiAgICAgICAgdGVtcCA9IHZlY3RvcnNbMF07XG4gICAgICAgIHRlbXAuY2xlYXJSZWdpb24oKTtcbiAgICAgICAgdmVjdG9yc1swXSA9IG5ldyBOb2RlKHRlbXAueCwgdGVtcC55LCB0ZW1wLnIsIGJsdWUsIDEsIDApO1xuICAgICAgICB2ZWN0b3JzWzBdLmRyYXcoKTtcbiAgICB9XG5cbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgdmVjdG9ycy5sZW5ndGggLSAxOyBpKyspe1xuICAgICAgICB0ZW1wID0gdmVjdG9yc1tpXTtcbiAgICAgICAgdmVjdG9yc1tpXS5jbGVhclJlZ2lvbigpO1xuICAgICAgICB2ZWN0b3JzW2ldID0gbmV3IE5vZGUodGVtcC54LCB0ZW1wLnksIHRlbXAuciwgd2hpdGUsIDEsIGkpO1xuICAgICAgICB2ZWN0b3JzW2ldLmRyYXcoKTtcbiAgICB9XG5cbiAgICBpZih2ZWN0b3JzLmxlbmd0aCA+IDEpe1xuICAgICAgICB0ZW1wID0gdmVjdG9yc1t2ZWN0b3JzLmxlbmd0aCAtIDFdO1xuICAgICAgICB0ZW1wLmNsZWFyUmVnaW9uKCk7XG4gICAgICAgIHZlY3RvcnNbdmVjdG9ycy5sZW5ndGggLSAxXSA9IG5ldyBOb2RlKHRlbXAueCwgdGVtcC55LCB0ZW1wLnIsIHJlZCwgMSwgdmVjdG9ycy5sZW5ndGggLSAxKTtcbiAgICAgICAgdmVjdG9yc1t2ZWN0b3JzLmxlbmd0aCAtIDFdLmRyYXcoKTtcbiAgICB9XG4gICAgXG59XG5cbmZ1bmN0aW9uIEVkZ2UoaGVhZCwgdGFpbCl7XG4gICAgdGhpcy5oZWFkID0gaGVhZDtcbiAgICB0aGlzLnRhaWwgPSB0YWlsO1xuXG4gICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rlc3RpbmF0aW9uLW92ZXInO1xuICAgICAgICBjdHgubW92ZVRvKGhlYWQueCwgaGVhZC55KTtcbiAgICAgICAgY3R4LmxpbmVUbyh0YWlsLngsIHRhaWwueSk7XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2Utb3Zlcic7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBOb2RlKHgsIHksIHIsIGZpbGwsIHN0cm9rZSwgaW5kZXgpIHtcbiAgICB0aGlzLnN0YXJ0aW5nQW5nbGUgPSAwO1xuICAgIHRoaXMuZW5kQW5nbGUgPSAyICogTWF0aC5QSTtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gICAgdGhpcy5yID0gcjtcbiAgICB0aGlzLnJlZ2lvbiA9IChzaXplIC8gNjApICogMi4yO1xuICAgIFxuICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICB0aGlzLmZpbGwgPSBmaWxsO1xuICAgIHRoaXMuc3Ryb2tlID0gc3Ryb2tlO1xuXG4gICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGN0eC5hcmModGhpcy54LCB0aGlzLnksIHRoaXMuciwgdGhpcy5zdGFydGluZ0FuZ2xlLCB0aGlzLmVuZEFuZ2xlKTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbDtcbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDM7XG4gICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMuc3Ryb2tlO1xuICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgIGlmKHIgPj0gc2l6ZSAvIDYwKXtcbiAgICAgICAgICAgIGN0eC5mb250ID0gJzhwdCBDYWxpYnJpJztcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGluZGV4LCB0aGlzLngsIHRoaXMueSszKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY2xlYXJSZWdpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY3R4LmNsZWFyUmVjdCh0aGlzLnggLSAodGhpcy5yZWdpb24gLyAyKSwgdGhpcy55IC0gKHRoaXMucmVnaW9uIC8gMiksIHRoaXMucmVnaW9uLCB0aGlzLnJlZ2lvbik7XG4gICAgfVxuXG4gICAgdGhpcy5pc0NsaWNrZWQgPSBmdW5jdGlvbiAoaW5feCwgaW5feSkge1xuICAgICAgICB2YXIgY2xpY2tlZCA9IGZhbHNlO1xuXG4gICAgICAgIGlmKGluX3ggPiAoeCAtIHIpICYmIGluX3ggPCAoeCArIHIpKXtcbiAgICAgICAgICAgIGlmKGluX3kgPiAoeSAtIHIpICYmIGluX3kgPCAoeSArIHIpKXtcbiAgICAgICAgICAgICAgICBjbGlja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGlja2VkO1xuICAgIH1cblxuICAgIHRoaXMuaXNDb2xsaXNpb24gPSBmdW5jdGlvbihhcnIpe1xuICAgICAgICB2YXIgY2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICBcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBpZihhcnJbaV0gIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgdmFyIGluX3ggPSBhcnJbaV0ueDtcbiAgICAgICAgICAgICAgICB2YXIgaW5feSA9IGFycltpXS55O1xuXG4gICAgICAgICAgICAgICAgaWYoaW5feCA+ICh4IC0gdGhpcy5yZWdpb24pICYmIGluX3ggPCAoeCArIHRoaXMucmVnaW9uKSl7XG4gICAgICAgICAgICAgICAgICAgIGlmKGluX3kgPiAoeSAtIHRoaXMucmVnaW9uKSAmJiBpbl95IDwgKHkgKyB0aGlzLnJlZ2lvbikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2xpY2tlZDtcblxuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVsTW91c2VDb29yZHMoZXZlbnQpe1xuICAgIHZhciB0b3RhbE9mZnNldFggPSAwO1xuICAgIHZhciB0b3RhbE9mZnNldFkgPSAwO1xuICAgIHZhciBjYW52YXNYID0gMDtcbiAgICB2YXIgY2FudmFzWSA9IDA7XG4gICAgdmFyIGN1cnJlbnRFbGVtZW50ID0gdGhpcztcblxuICAgIGRve1xuICAgICAgICB0b3RhbE9mZnNldFggKz0gY3VycmVudEVsZW1lbnQub2Zmc2V0TGVmdCAtIGN1cnJlbnRFbGVtZW50LnNjcm9sbExlZnQ7XG4gICAgICAgIHRvdGFsT2Zmc2V0WSArPSBjdXJyZW50RWxlbWVudC5vZmZzZXRUb3AgLSBjdXJyZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgfVxuICAgIHdoaWxlKGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQub2Zmc2V0UGFyZW50KVxuXG4gICAgY2FudmFzWCA9IGV2ZW50LnBhZ2VYIC0gdG90YWxPZmZzZXRYO1xuICAgIGNhbnZhc1kgPSBldmVudC5wYWdlWSAtIHRvdGFsT2Zmc2V0WTtcblxuICAgIHJldHVybiB7eDpjYW52YXNYLCB5OmNhbnZhc1l9XG59XG5cbmZ1bmN0aW9uIGlzRXF1YWwoYSwgYil7XG4gICAgdmFyIHNpemUgPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpO1xuICAgIHZhciByZXN1bHQgPSB0cnVlO1xuXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKyl7XG4gICAgICAgIGlmKGFbaV0gIT0gYltpXSl7XG4gICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbkhUTUxDYW52YXNFbGVtZW50LnByb3RvdHlwZS5yZWxNb3VzZUNvb3JkcyA9IHJlbE1vdXNlQ29vcmRzO1xuXG5DYW52YXNSZW5kZXJpbmdDb250ZXh0MkQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKXtcbiAgICBjdHguY2xlYXJSZWN0KDAsMCxzaXplLHNpemUpO1xuICAgIHZlY3RvcnMgPSBbXTtcbn0iXX0=
