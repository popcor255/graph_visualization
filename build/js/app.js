var htmlCanvas,ctx,win_l,win_h,size,radius,vectors,edges,mousePos,coords,blue="#5a8ded",red="#d61d45",white="#f3f7f3";function main(){htmlCanvas=document.getElementById("myCanvas"),ctx=htmlCanvas.getContext("2d"),vectors=[],edges=[],mousePos=[],win_l=.96*window.innerWidth,win_h=.96*window.innerHeight,size=Math.min(win_h,win_l),radius=size/70,ctx.canvas.width=size,ctx.canvas.height=size,htmlCanvas.addEventListener("mousedown",function(e){coords=htmlCanvas.relMouseCoords(event),mousePos=[coords.x,coords.y]},!1),htmlCanvas.addEventListener("mouseup",function(e){if(ctx.clear(),coords=htmlCanvas.relMouseCoords(event),1===e.which&&isClose(mousePos,[coords.x,coords.y],radius)){nodeEventHandler(coords,radius,!1,null)}else if(1==e.which){var t=getVectorByPosition(mousePos,vectors,null),s=getVectorByPosition([coords.x,coords.y],vectors,t);null!=t&&null!=s&&edges.push(new Edge(t,s))}drawEdges(),drawNodes(),mousePos=[coords.x,coords.y]},!1),htmlCanvas.addEventListener("wheel",function(e){scrollEvent(e)},!1)}function scrollEvent(e){var t=0,s=e.deltaY;0<vectors.length&&(s<0&&size/65<=radius&&(console.log("down"),t=-2),0<s&&radius<=size/60&&(console.log("up"),t=2)),radius+=t;for(var o=0;o<vectors.length;o++)temp=vectors[o],vectors[o].clearRegion(),vectors[o]=new Node(temp.x,temp.y,radius,temp.fill,1,o),vectors[o].draw()}function nodeEventHandler(e,t,s,o){if(e.x>t&&e.x<size-t&&e.y>t&&e.y<size-t){for(var i=0;i<vectors.length;i++)null!=(o=vectors[i])&&o.isClicked(e.x,e.y)&&(o.clearRegion(),vectors.splice(i,1),s=!0);0==s&&((o=new Node(e.x,e.y,t,white,1,vectors.length-1)).isCollision(vectors)||vectors.push(o))}}function drawEdges(){for(var e=!0,t=0;t<edges.length;t++)e=!1,console.log(doesExist(vectors,[edges[t].head,edges[t].tail])),doesExist(vectors,[edges[t].head,edges[t].tail])&&(e=!0),e?edges[t].draw():(removeEdges(edges[t].head.index),removeEdges(edges[t].tail.index))}function drawNodes(){0<vectors.length&&(temp=vectors[0],temp.clearRegion(),vectors[0]=new Node(temp.x,temp.y,temp.r,blue,1,0),vectors[0].draw());for(var e=1;e<vectors.length-1;e++)temp=vectors[e],vectors[e].clearRegion(),vectors[e]=new Node(temp.x,temp.y,temp.r,white,1,e),vectors[e].draw();1<vectors.length&&(temp=vectors[vectors.length-1],temp.clearRegion(),vectors[vectors.length-1]=new Node(temp.x,temp.y,temp.r,red,1,vectors.length-1),vectors[vectors.length-1].draw())}function removeEdges(e){for(var t=0;t<edges.length;t++)edges[t].head.index!=e&&edges[t].tail.index!=e||edges.splice(t,1)}function Edge(e,t){this.head=e,this.tail=t,this.drawn=!1,this.draw=function(){ctx.beginPath(),ctx.globalCompositeOperation="destination-over",ctx.moveTo(e.x,e.y),ctx.lineTo(t.x,t.y),ctx.strokeStyle=white,ctx.stroke(),ctx.globalCompositeOperation="source-over",this.drawn=!0},this.draw()}function Node(n,r,o,e,t,s){this.startingAngle=0,this.endAngle=2*Math.PI,this.x=n,this.y=r,this.r=o,this.lineWidth=4,this.region=size/60*2.2+this.lineWidth,this.index=s,this.fill=e,this.stroke=t,ctx.strokeStyle=white,this.draw=function(){ctx.beginPath(),ctx.arc(this.x,this.y,this.r,this.startingAngle,this.endAngle),ctx.fillStyle=this.fill,ctx.lineWidth=this.lineWidth-1,ctx.fill(),ctx.strokeStyle=this.stroke,ctx.stroke(),size/60<=o&&(ctx.font="12pt Gill Sans",ctx.fillStyle="black",ctx.textAlign="center",ctx.fillText(s,this.x,this.y+3))},this.clearRegion=function(){ctx.clearRect(this.x-this.region/2,this.y-this.region/2,this.region,this.region)},this.isClicked=function(e,t){var s=!1;return n-o<e&&e<n+o&&r-o<t&&t<r+o&&(s=!0),s},this.isCollision=function(e){for(var t=!1,s=0;s<e.length;s++)if(null!=e[s]){var o=e[s].x,i=e[s].y;o>n-this.region&&o<n+this.region&&i>r-this.region&&i<r+this.region&&(t=!0)}return t}}function relMouseCoords(e){for(var t=0,s=0,o=this;t+=o.offsetLeft-o.scrollLeft,s+=o.offsetTop-o.scrollTop,o=o.offsetParent;);return{x:e.pageX-t,y:e.pageY-s}}function isClose(e,t,s){for(var o=Math.min(e.length,t.length),i=!0,n=0;n<o;n++)s<Math.abs(e[n]-t[n])&&(i=!1);return i}function getVectorByPosition(e,t,s){for(var o=null,i=0;i<t.length;i++)if(t[i].isClicked(e[0],e[1])&&t[i]!=s){o=t[i];break}return o}function doesExist(e,t){for(var s=!1,o=!1,i=0;i<e.length;i++)if(t[0].index==e[i].index&&(s=!0),t[1].index==e[i].index&&(o=!0),1==s&&1==o)return!0;return!1}HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords,CanvasRenderingContext2D.prototype.clear=function(){ctx.clearRect(0,0,size,size)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaHRtbENhbnZhcyIsImN0eCIsIndpbl9sIiwid2luX2giLCJzaXplIiwicmFkaXVzIiwidmVjdG9ycyIsImVkZ2VzIiwibW91c2VQb3MiLCJjb29yZHMiLCJibHVlIiwicmVkIiwid2hpdGUiLCJtYWluIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldENvbnRleHQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJNYXRoIiwibWluIiwiY2FudmFzIiwid2lkdGgiLCJoZWlnaHQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXYiLCJyZWxNb3VzZUNvb3JkcyIsImV2ZW50IiwieCIsInkiLCJjbGVhciIsIndoaWNoIiwiaXNDbG9zZSIsIm5vZGVFdmVudEhhbmRsZXIiLCJoIiwiZ2V0VmVjdG9yQnlQb3NpdGlvbiIsInQiLCJwdXNoIiwiRWRnZSIsImRyYXdFZGdlcyIsImRyYXdOb2RlcyIsInNjcm9sbEV2ZW50Iiwic2Nyb2xsIiwiZGVsdGFZIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsImkiLCJ0ZW1wIiwiY2xlYXJSZWdpb24iLCJOb2RlIiwiZmlsbCIsImRyYXciLCJyZW1vdmVkIiwiaXNDbGlja2VkIiwic3BsaWNlIiwiaXNDb2xsaXNpb24iLCJpc0ZvdW5kIiwiZG9lc0V4aXN0IiwiaGVhZCIsInRhaWwiLCJyZW1vdmVFZGdlcyIsImluZGV4IiwiciIsImUiLCJ0aGlzIiwiZHJhd24iLCJiZWdpblBhdGgiLCJnbG9iYWxDb21wb3NpdGVPcGVyYXRpb24iLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2VTdHlsZSIsInN0cm9rZSIsInN0YXJ0aW5nQW5nbGUiLCJlbmRBbmdsZSIsIlBJIiwibGluZVdpZHRoIiwicmVnaW9uIiwiYXJjIiwiZmlsbFN0eWxlIiwiZm9udCIsInRleHRBbGlnbiIsImZpbGxUZXh0IiwiY2xlYXJSZWN0IiwiaW5feCIsImluX3kiLCJjbGlja2VkIiwiYXJyIiwidG90YWxPZmZzZXRYIiwidG90YWxPZmZzZXRZIiwiY3VycmVudEVsZW1lbnQiLCJvZmZzZXRMZWZ0Iiwic2Nyb2xsTGVmdCIsIm9mZnNldFRvcCIsInNjcm9sbFRvcCIsIm9mZnNldFBhcmVudCIsInBhZ2VYIiwicGFnZVkiLCJhIiwiYiIsImZhY3RvciIsInJlc3VsdCIsImFicyIsInBvcyIsInYiLCJvbWl0IiwiaXNIZWFkIiwiaXNUYWlsIiwiSFRNTENhbnZhc0VsZW1lbnQiLCJwcm90b3R5cGUiLCJDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQ0FDLElBQ0FDLE1BQ0FDLE1BQ0FDLEtBQ0FDLE9BQ0FDLFFBQ0FDLE1BQ0FDLFNBQ0FDLE9BRUFDLEtBQU8sVUFDUEMsSUFBTSxVQUNOQyxNQUFRLFVBRVosU0FBU0MsT0FDTGIsV0FBYWMsU0FBU0MsZUFBZSxZQUNyQ2QsSUFBTUQsV0FBV2dCLFdBQVcsTUFDNUJWLFFBQVUsR0FDVkMsTUFBUSxHQUNSQyxTQUFXLEdBQ1hOLE1BQTRCLElBQXBCZSxPQUFPQyxXQUNmZixNQUE2QixJQUFyQmMsT0FBT0UsWUFDZmYsS0FBT2dCLEtBQUtDLElBQUlsQixNQUFPRCxPQUN2QkcsT0FBU0QsS0FBTyxHQUNoQkgsSUFBSXFCLE9BQU9DLE1BQVNuQixLQUNwQkgsSUFBSXFCLE9BQU9FLE9BQVNwQixLQUVwQkosV0FBV3lCLGlCQUFpQixZQUFjLFNBQVNDLEdBQy9DakIsT0FBU1QsV0FBVzJCLGVBQWVDLE9BQ25DcEIsU0FBVyxDQUFDQyxPQUFPb0IsRUFBR3BCLE9BQU9xQixLQUM5QixHQUdIOUIsV0FBV3lCLGlCQUFpQixVQUFZLFNBQVNDLEdBSTdDLEdBSEF6QixJQUFJOEIsUUFDSnRCLE9BQVNULFdBQVcyQixlQUFlQyxPQUVsQixJQUFiRixFQUFHTSxPQUFlQyxRQUFRekIsU0FBVSxDQUFDQyxPQUFPb0IsRUFBSXBCLE9BQU9xQixHQUFJLFFBQVcsQ0FJdEVJLGlCQUFpQnpCLE9BQVFKLFFBSFgsRUFDSCxX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VlIsRUFBRSxHQUFHcEMsT0FBUzBDLEVBQUV6RCxHQUFHZSxRQUNsQjZDLEdBQVMsR0FHQSxHQUFWRCxHQUE0QixHQUFWQyxFQUNqQixPQUFPLEVBS2YsT0FBTyxFQUdYQyxrQkFBa0JDLFVBQVVuRixlQUFpQkEsZUFFN0NvRix5QkFBeUJELFVBQVUvRSxNQUFRLFdBQ3ZDOUIsSUFBSW1GLFVBQVUsRUFBRSxFQUFFaEYsS0FBS0EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGh0bWxDYW52YXM7XG52YXIgY3R4O1xudmFyIHdpbl9sO1xudmFyIHdpbl9oO1xudmFyIHNpemU7XG52YXIgcmFkaXVzO1xudmFyIHZlY3RvcnM7XG52YXIgZWRnZXM7XG52YXIgbW91c2VQb3M7XG52YXIgY29vcmRzO1xuXG52YXIgYmx1ZSA9IFwiIzVhOGRlZFwiO1xudmFyIHJlZCA9IFwiI2Q2MWQ0NVwiO1xudmFyIHdoaXRlID0gXCIjZjNmN2YzXCI7XG5cbmZ1bmN0aW9uIG1haW4oKSB7XG4gICAgaHRtbENhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXlDYW52YXNcIik7XG4gICAgY3R4ID0gaHRtbENhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHZlY3RvcnMgPSBbXTtcbiAgICBlZGdlcyA9IFtdO1xuICAgIG1vdXNlUG9zID0gW107XG4gICAgd2luX2wgPSB3aW5kb3cuaW5uZXJXaWR0aCAqIDAuOTY7XG4gICAgd2luX2ggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjk2O1xuICAgIHNpemUgPSBNYXRoLm1pbih3aW5faCwgd2luX2wpO1xuICAgIHJhZGl1cyA9IHNpemUgLyA3MDtcbiAgICBjdHguY2FudmFzLndpZHRoICA9IHNpemU7XG4gICAgY3R4LmNhbnZhcy5oZWlnaHQgPSBzaXplO1xuXG4gICAgaHRtbENhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICBmdW5jdGlvbihldikge1xuICAgICAgICBjb29yZHMgPSBodG1sQ2FudmFzLnJlbE1vdXNlQ29vcmRzKGV2ZW50KTtcbiAgICAgICAgbW91c2VQb3MgPSBbY29vcmRzLngsIGNvb3Jkcy55XTtcbiAgICB9LCBmYWxzZSk7XG5cblxuICAgIGh0bWxDYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGN0eC5jbGVhcigpO1xuICAgICAgICBjb29yZHMgPSBodG1sQ2FudmFzLnJlbE1vdXNlQ29vcmRzKGV2ZW50KTtcblxuICAgICAgICBpZiAoZXYud2hpY2ggPT09IDEgJiYgaXNDbG9zZShtb3VzZVBvcywgW2Nvb3Jkcy54ICwgY29vcmRzLnldLCAocmFkaXVzKSkpIHtcbiAgICAgICAgICAgIHZhciByZW1vdmVkID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IG51bGw7XG5cbiAgICAgICAgICAgIG5vZGVFdmVudEhhbmRsZXIoY29vcmRzLCByYWRpdXMsIHJlbW92ZWQsIHRlbXApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoZXYud2hpY2ggPT0gMSl7XG4gICAgICAgICAgICB2YXIgaCA9IGdldFZlY3RvckJ5UG9zaXRpb24obW91c2VQb3MsIHZlY3RvcnMsIG51bGwpO1xuICAgICAgICAgICAgdmFyIHQgPSBnZXRWZWN0b3JCeVBvc2l0aW9uKFtjb29yZHMueCwgY29vcmRzLnldLCB2ZWN0b3JzLCBoKTtcblxuICAgICAgICAgICAgaWYoaCAhPSBudWxsICYmIHQgIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgZWRnZXMucHVzaChuZXcgRWRnZShoLCB0KSk7XG4gICAgICAgICAgICB9ICAgIFxuICAgICAgICB9XG5cbiAgICAgICAgZHJhd0VkZ2VzKCk7XG4gICAgICAgIGRyYXdOb2RlcygpO1xuXG4gICAgICAgIG1vdXNlUG9zID0gW2Nvb3Jkcy54LCBjb29yZHMueV07XG4gICAgfSwgZmFsc2UpO1xuXG5cbiAgICBodG1sQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgc2Nyb2xsRXZlbnQoZXYpO1xuICAgIH0sIGZhbHNlKTtcbn1cblxuZnVuY3Rpb24gc2Nyb2xsRXZlbnQoZXYpe1xuICAgIHZhciBzY3JvbGwgPSAwO1xuICAgIHZhciB5ID0gZXYuZGVsdGFZO1xuXG4gICAgaWYodmVjdG9ycy5sZW5ndGggPiAwKXtcbiAgICAgICAgaWYgKHkgPCAwICYmIHJhZGl1cyA+PSAoc2l6ZSAvIDY1KSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJkb3duXCIpO1xuICAgICAgICAgICAgc2Nyb2xsID0gLTI7ICAgXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoeSA+IDAgJiYgcmFkaXVzIDw9IChzaXplIC8gNjApKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVwXCIpO1xuICAgICAgICAgICAgc2Nyb2xsID0gMjsgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJhZGl1cyArPSBzY3JvbGw7XG5cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdmVjdG9ycy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIHRlbXAgPSB2ZWN0b3JzW2ldO1xuICAgICAgICB2ZWN0b3JzW2ldLmNsZWFyUmVnaW9uKCk7XG4gICAgICAgIHZlY3RvcnNbaV0gPSBuZXcgTm9kZSh0ZW1wLngsIHRlbXAueSwgcmFkaXVzLCB0ZW1wLmZpbGwsIDEsIGkpO1xuICAgICAgICB2ZWN0b3JzW2ldLmRyYXcoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vZGVFdmVudEhhbmRsZXIoY29vcmRzLCByYWRpdXMsIHJlbW92ZWQsIHRlbXApe1xuXG4gICAgLy9UaGUgY29uZGl0aW9ucyBnbyBhcyBmb2xsb3dzOlxuICAgIC8vMSkgVGhlIGNpcmNsZSBtdXN0IGZpdCBpbiB0aGUgY2FudmFzIChsaW5lcyA0Mi00MylcbiAgICAvLzIpIFRoZSBjaXJjbGUgbXVzdCBub3Qgb3ZlcmxhcCAobGluZXMgNDcpXG4gICAgLy8zKSBJZiB0aGUgY2lyY2xlIGlzIGFscmVhZHkgcHJlc2VudCBkbyBub3QgYWRkLCBidXQgcmVtb3ZlXG5cbiAgICBpZihjb29yZHMueCA+IHJhZGl1cyAmJiBjb29yZHMueCA8IHNpemUgLSByYWRpdXMpe1xuICAgICAgICBpZihjb29yZHMueSA+IHJhZGl1cyAmJiBjb29yZHMueSA8IHNpemUgLSByYWRpdXMpe1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHZlY3RvcnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIHRlbXAgPSB2ZWN0b3JzW2ldO1xuICAgICAgICAgICAgICAgIGlmKHRlbXAgIT0gbnVsbCAmJiB0ZW1wLmlzQ2xpY2tlZChjb29yZHMueCwgY29vcmRzLnkpKXtcbiAgICAgICAgICAgICAgICAgICAgdGVtcC5jbGVhclJlZ2lvbigpO1xuICAgICAgICAgICAgICAgICAgICB2ZWN0b3JzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZihyZW1vdmVkID09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICB0ZW1wID0gbmV3IE5vZGUoY29vcmRzLngsIGNvb3Jkcy55LCByYWRpdXMsIHdoaXRlLCAxLCB2ZWN0b3JzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIGlmKCF0ZW1wLmlzQ29sbGlzaW9uKHZlY3RvcnMpKXtcbiAgICAgICAgICAgICAgICAgICAgdmVjdG9ycy5wdXNoKHRlbXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybjtcbiAgICBcbn1cblxuZnVuY3Rpb24gZHJhd0VkZ2VzKCl7XG4gICAgdmFyIGlzRm91bmQgPSB0cnVlO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBlZGdlcy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGlzRm91bmQgPSBmYWxzZTtcbiAgICAgICAgY29uc29sZS5sb2coZG9lc0V4aXN0KHZlY3RvcnMsIFtlZGdlc1tpXS5oZWFkLCBlZGdlc1tpXS50YWlsXSkpO1xuICAgICAgICBpZihkb2VzRXhpc3QodmVjdG9ycywgW2VkZ2VzW2ldLmhlYWQsIGVkZ2VzW2ldLnRhaWxdKSl7XG4gICAgICAgICAgICBpc0ZvdW5kID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGlzRm91bmQpe1xuICAgICAgICAgICAgZWRnZXNbaV0uZHJhdygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICByZW1vdmVFZGdlcyhlZGdlc1tpXS5oZWFkLmluZGV4KTtcbiAgICAgICAgICAgIHJlbW92ZUVkZ2VzKGVkZ2VzW2ldLnRhaWwuaW5kZXgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybjtcbn1cblxuZnVuY3Rpb24gZHJhd05vZGVzKCl7XG4gICAgXG4gICAgLy9yZWRyYXcgbm9kZXMgYXMgZm9sbG93c1xuICAgIC8vaWYgdGhlIGhlYWQgeW91ciBibHVlXG4gICAgLy9pZiB0aGUgdGFpbCB5b3VyIHJlZFxuICAgIC8vZWxzZSB5b3VyIGdyZWVuXG5cbiAgICBpZih2ZWN0b3JzLmxlbmd0aCA+IDApe1xuICAgICAgICB0ZW1wID0gdmVjdG9yc1swXTtcbiAgICAgICAgdGVtcC5jbGVhclJlZ2lvbigpO1xuICAgICAgICB2ZWN0b3JzWzBdID0gbmV3IE5vZGUodGVtcC54LCB0ZW1wLnksIHRlbXAuciwgYmx1ZSwgMSwgMCk7XG4gICAgICAgIHZlY3RvcnNbMF0uZHJhdygpO1xuICAgIH1cblxuICAgIGZvcih2YXIgaSA9IDE7IGkgPCB2ZWN0b3JzLmxlbmd0aCAtIDE7IGkrKyl7XG4gICAgICAgIHRlbXAgPSB2ZWN0b3JzW2ldO1xuICAgICAgICB2ZWN0b3JzW2ldLmNsZWFyUmVnaW9uKCk7XG4gICAgICAgIHZlY3RvcnNbaV0gPSBuZXcgTm9kZSh0ZW1wLngsIHRlbXAueSwgdGVtcC5yLCB3aGl0ZSwgMSwgaSk7XG4gICAgICAgIHZlY3RvcnNbaV0uZHJhdygpO1xuICAgIH1cblxuICAgIGlmKHZlY3RvcnMubGVuZ3RoID4gMSl7XG4gICAgICAgIHRlbXAgPSB2ZWN0b3JzW3ZlY3RvcnMubGVuZ3RoIC0gMV07XG4gICAgICAgIHRlbXAuY2xlYXJSZWdpb24oKTtcbiAgICAgICAgdmVjdG9yc1t2ZWN0b3JzLmxlbmd0aCAtIDFdID0gbmV3IE5vZGUodGVtcC54LCB0ZW1wLnksIHRlbXAuciwgcmVkLCAxLCB2ZWN0b3JzLmxlbmd0aCAtIDEpO1xuICAgICAgICB2ZWN0b3JzW3ZlY3RvcnMubGVuZ3RoIC0gMV0uZHJhdygpO1xuICAgIH1cblxuICAgIHJldHVybjtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlRWRnZXMoZSl7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGVkZ2VzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgaWYoZWRnZXNbaV0uaGVhZC5pbmRleCA9PSBlIHx8IGVkZ2VzW2ldLnRhaWwuaW5kZXggPT0gZSl7XG4gICAgICAgICAgICBlZGdlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIEVkZ2UoaGVhZCwgdGFpbCl7XG4gICAgdGhpcy5oZWFkID0gaGVhZDtcbiAgICB0aGlzLnRhaWwgPSB0YWlsO1xuICAgIHRoaXMuZHJhd24gPSBmYWxzZTtcblxuICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdkZXN0aW5hdGlvbi1vdmVyJztcbiAgICAgICAgY3R4Lm1vdmVUbyhoZWFkLngsIGhlYWQueSk7XG4gICAgICAgIGN0eC5saW5lVG8odGFpbC54LCB0YWlsLnkpO1xuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB3aGl0ZTtcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcbiAgICAgICAgdGhpcy5kcmF3biA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy5kcmF3KCk7XG59XG5cbmZ1bmN0aW9uIE5vZGUoeCwgeSwgciwgZmlsbCwgc3Ryb2tlLCBpbmRleCkge1xuICAgIHRoaXMuc3RhcnRpbmdBbmdsZSA9IDA7XG4gICAgdGhpcy5lbmRBbmdsZSA9IDIgKiBNYXRoLlBJO1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnIgPSByO1xuICAgIHRoaXMubGluZVdpZHRoID0gNDtcbiAgICB0aGlzLnJlZ2lvbiA9ICgoc2l6ZSAvIDYwKSAqIDIuMikgKyB0aGlzLmxpbmVXaWR0aDtcbiAgICBcbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgdGhpcy5maWxsID0gZmlsbDtcbiAgICB0aGlzLnN0cm9rZSA9IHN0cm9rZTtcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSB3aGl0ZTtcblxuXG4gICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGN0eC5hcmModGhpcy54LCB0aGlzLnksIHRoaXMuciwgdGhpcy5zdGFydGluZ0FuZ2xlLCB0aGlzLmVuZEFuZ2xlKTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbDtcbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoIC0gMTtcbiAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5zdHJva2U7XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgaWYociA+PSBzaXplIC8gNjApe1xuICAgICAgICAgICAgY3R4LmZvbnQgPSAnMTJwdCBHaWxsIFNhbnMnO1xuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICdibGFjayc7XG4gICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICAgICAgICBjdHguZmlsbFRleHQoaW5kZXgsIHRoaXMueCwgdGhpcy55KzMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhclJlZ2lvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjdHguY2xlYXJSZWN0KHRoaXMueCAtICh0aGlzLnJlZ2lvbiAvIDIpLCB0aGlzLnkgLSAodGhpcy5yZWdpb24gLyAyKSwgdGhpcy5yZWdpb24sIHRoaXMucmVnaW9uKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQ2xpY2tlZCA9IGZ1bmN0aW9uIChpbl94LCBpbl95KSB7XG4gICAgICAgIHZhciBjbGlja2VkID0gZmFsc2U7XG5cbiAgICAgICAgaWYoaW5feCA+ICh4IC0gcikgJiYgaW5feCA8ICh4ICsgcikpe1xuICAgICAgICAgICAgaWYoaW5feSA+ICh5IC0gcikgJiYgaW5feSA8ICh5ICsgcikpe1xuICAgICAgICAgICAgICAgIGNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNsaWNrZWQ7XG4gICAgfVxuXG4gICAgdGhpcy5pc0NvbGxpc2lvbiA9IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciBjbGlja2VkID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmKGFycltpXSAhPSBudWxsKXtcbiAgICAgICAgICAgICAgICB2YXIgaW5feCA9IGFycltpXS54O1xuICAgICAgICAgICAgICAgIHZhciBpbl95ID0gYXJyW2ldLnk7XG5cbiAgICAgICAgICAgICAgICBpZihpbl94ID4gKHggLSB0aGlzLnJlZ2lvbikgJiYgaW5feCA8ICh4ICsgdGhpcy5yZWdpb24pKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5feSA+ICh5IC0gdGhpcy5yZWdpb24pICYmIGluX3kgPCAoeSArIHRoaXMucmVnaW9uKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGlja2VkO1xuXG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWxNb3VzZUNvb3JkcyhldmVudCl7XG4gICAgdmFyIHRvdGFsT2Zmc2V0WCA9IDA7XG4gICAgdmFyIHRvdGFsT2Zmc2V0WSA9IDA7XG4gICAgdmFyIGNhbnZhc1ggPSAwO1xuICAgIHZhciBjYW52YXNZID0gMDtcbiAgICB2YXIgY3VycmVudEVsZW1lbnQgPSB0aGlzO1xuXG4gICAgZG97XG4gICAgICAgIHRvdGFsT2Zmc2V0WCArPSBjdXJyZW50RWxlbWVudC5vZmZzZXRMZWZ0IC0gY3VycmVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICAgICAgdG90YWxPZmZzZXRZICs9IGN1cnJlbnRFbGVtZW50Lm9mZnNldFRvcCAtIGN1cnJlbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICB9XG4gICAgd2hpbGUoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5vZmZzZXRQYXJlbnQpXG5cbiAgICBjYW52YXNYID0gZXZlbnQucGFnZVggLSB0b3RhbE9mZnNldFg7XG4gICAgY2FudmFzWSA9IGV2ZW50LnBhZ2VZIC0gdG90YWxPZmZzZXRZO1xuXG4gICAgcmV0dXJuIHt4OmNhbnZhc1gsIHk6Y2FudmFzWX1cbn1cblxuZnVuY3Rpb24gaXNDbG9zZShhLCBiLCBmYWN0b3Ipe1xuICAgIHZhciBzaXplID0gTWF0aC5taW4oYS5sZW5ndGgsIGIubGVuZ3RoKTtcbiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICB2YXIgZGlmZiA9IDA7IFxuXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKyl7XG4gICAgICAgIGRpZmYgPSBNYXRoLmFicyhhW2ldIC0gYltpXSk7XG4gICAgICAgIFxuICAgICAgICBpZihkaWZmID4gZmFjdG9yKXtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZ2V0VmVjdG9yQnlQb3NpdGlvbihwb3MsIHYsIG9taXQpe1xuICAgIHZhciByID0gbnVsbDtcblxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgaWYodltpXS5pc0NsaWNrZWQocG9zWzBdLCBwb3NbMV0pKXtcbiAgICAgICAgICAgIGlmKHZbaV0gIT0gb21pdCl7XG4gICAgICAgICAgICAgICAgciA9IHZbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcjtcbn1cblxuZnVuY3Rpb24gZG9lc0V4aXN0KHYsIGEpe1xuICAgIHZhciBpc0hlYWQgPSBmYWxzZTtcbiAgICB2YXIgaXNUYWlsID0gZmFsc2U7XG5cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgdi5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgaWYoYVswXS5pbmRleCA9PSB2W2ldLmluZGV4KXtcbiAgICAgICAgICAgIGlzSGVhZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZihhWzFdLmluZGV4ID09IHZbaV0uaW5kZXgpe1xuICAgICAgICAgICAgaXNUYWlsID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGlzSGVhZCA9PSB0cnVlICYmIGlzVGFpbCA9PSB0cnVlKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLnJlbE1vdXNlQ29vcmRzID0gcmVsTW91c2VDb29yZHM7XG5cbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpe1xuICAgIGN0eC5jbGVhclJlY3QoMCwwLHNpemUsc2l6ZSk7XG59Il19
