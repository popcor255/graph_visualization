var htmlCanvas,ctx,win_l,win_h,size,radius,vectors,edges,mousePos,coords,blue="#5a8ded",red="#d61d45",white="#f3f7f3";function main(){htmlCanvas=document.getElementById("myCanvas"),ctx=htmlCanvas.getContext("2d"),vectors=[],edges=[],mousePos=[],win_l=.96*window.innerWidth,win_h=.96*window.innerHeight,size=Math.min(win_h,win_l),radius=size/70,ctx.canvas.width=size,ctx.canvas.height=size,htmlCanvas.addEventListener("mousedown",function(e){coords=htmlCanvas.relMouseCoords(event),mousePos=[coords.x,coords.y]},!1),htmlCanvas.addEventListener("mouseup",function(e){if(ctx.clear(),coords=htmlCanvas.relMouseCoords(event),1===e.which&&isClose(mousePos,[coords.x,coords.y],radius)){nodeEventHandler(coords,radius,!1,null)}else if(1==e.which){var t=getVectorByPosition(mousePos,vectors,null),o=getVectorByPosition([coords.x,coords.y],vectors,t);null!=t&&null!=o&&edges.push(new Edge(t,o))}drawNodes(),drawEdges(),mousePos=[coords.x,coords.y]},!1),htmlCanvas.addEventListener("wheel",function(e){scrollEvent(e)},!1)}function scrollEvent(e){var t=0,o=e.deltaY;0<vectors.length&&(o<0&&size/65<=radius&&(console.log("down"),t=-2),0<o&&radius<=size/60&&(console.log("up"),t=2)),radius+=t;for(var s=0;s<vectors.length;s++)temp=vectors[s],vectors[s].clearRegion(),vectors[s]=new Node(temp.x,temp.y,radius,temp.fill,1,s),vectors[s].draw()}function nodeEventHandler(e,t,o,s){if(e.x>t&&e.x<size-t&&e.y>t&&e.y<size-t){for(var i=0;i<vectors.length;i++)null!=(s=vectors[i])&&s.isClicked(e.x,e.y)&&(s.clearRegion(),removeEdges(vectors[i]),vectors.splice(i,1),o=!0);0==o&&((s=new Node(e.x,e.y,t,white,1,vectors.length-1)).isCollision(vectors)||vectors.push(s))}}function drawEdges(){for(var e=0;e<edges.length;e++)edges[e].draw()}function removeEdges(e){for(var t=null,o=null,s=edges.length-1;0<=s;)t=edges[s].head.index,o=edges[s].tail.index,t==e.index||o==e.index?edges.splice(s,1):console.log("sa"),s--}function drawNodes(){0<vectors.length&&(temp=vectors[0],temp.clearRegion(),vectors[0]=new Node(temp.x,temp.y,temp.r,blue,1,0),vectors[0].draw());for(var e=1;e<vectors.length-1;e++)temp=vectors[e],vectors[e].clearRegion(),vectors[e]=new Node(temp.x,temp.y,temp.r,white,1,e),vectors[e].draw();1<vectors.length&&(temp=vectors[vectors.length-1],temp.clearRegion(),vectors[vectors.length-1]=new Node(temp.x,temp.y,temp.r,red,1,vectors.length-1),vectors[vectors.length-1].draw())}function Edge(e,t){this.head=e,this.tail=t,this.drawn=!1,this.draw=function(){ctx.beginPath(),ctx.globalCompositeOperation="destination-over",ctx.moveTo(e.x,e.y),ctx.lineTo(t.x,t.y),ctx.strokeStyle=white,ctx.stroke(),ctx.globalCompositeOperation="source-over",this.drawn=!0},this.draw()}function Node(n,r,s,e,t,o){this.startingAngle=0,this.endAngle=2*Math.PI,this.x=n,this.y=r,this.r=s,this.lineWidth=4,this.region=size/60*2.2+this.lineWidth,this.index=o,this.fill=e,this.stroke=t,ctx.strokeStyle=white,this.draw=function(){ctx.beginPath(),ctx.arc(this.x,this.y,this.r,this.startingAngle,this.endAngle),ctx.fillStyle=this.fill,ctx.lineWidth=this.lineWidth-1,ctx.fill(),ctx.strokeStyle=this.stroke,ctx.stroke(),size/60<=s&&(ctx.font="12pt Gill Sans",ctx.fillStyle="black",ctx.textAlign="center",ctx.fillText(o,this.x,this.y+3))},this.clearRegion=function(){ctx.clearRect(this.x-this.region/2,this.y-this.region/2,this.region,this.region)},this.isClicked=function(e,t){var o=!1;return n-s<e&&e<n+s&&r-s<t&&t<r+s&&(o=!0),o},this.isCollision=function(e){for(var t=!1,o=0;o<e.length;o++)if(null!=e[o]){var s=e[o].x,i=e[o].y;s>n-this.region&&s<n+this.region&&i>r-this.region&&i<r+this.region&&(t=!0)}return t}}function relMouseCoords(e){for(var t=0,o=0,s=this;t+=s.offsetLeft-s.scrollLeft,o+=s.offsetTop-s.scrollTop,s=s.offsetParent;);return{x:e.pageX-t,y:e.pageY-o}}function isClose(e,t,o){for(var s=Math.min(e.length,t.length),i=!0,n=0;n<s;n++)o<Math.abs(e[n]-t[n])&&(i=!1);return i}function getVectorByPosition(e,t,o){for(var s=null,i=0;i<t.length;i++)if(t[i].isClicked(e[0],e[1])&&t[i]!=o){s=t[i];break}return s}HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords,CanvasRenderingContext2D.prototype.clear=function(){ctx.clearRect(0,0,size,size)};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiaHRtbENhbnZhcyIsImN0eCIsIndpbl9sIiwid2luX2giLCJzaXplIiwicmFkaXVzIiwidmVjdG9ycyIsImVkZ2VzIiwibW91c2VQb3MiLCJjb29yZHMiLCJibHVlIiwicmVkIiwid2hpdGUiLCJtYWluIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldENvbnRleHQiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJNYXRoIiwibWluIiwiY2FudmFzIiwid2lkdGgiLCJoZWlnaHQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXYiLCJyZWxNb3VzZUNvb3JkcyIsImV2ZW50IiwieCIsInkiLCJjbGVhciIsIndoaWNoIiwiaXNDbG9zZSIsIm5vZGVFdmVudEhhbmRsZXIiLCJoIiwiZ2V0VmVjdG9yQnlQb3NpdGlvbiIsInQiLCJwdXNoIiwiRWRnZSIsImRyYXdOb2RlcyIsImRyYXdFZGdlcyIsInNjcm9sbEV2ZW50Iiwic2Nyb2xsIiwiZGVsdGFZIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsImkiLCJ0ZW1wIiwiY2xlYXJSZWdpb24iLCJOb2RlIiwiZmlsbCIsImRyYXciLCJyZW1vdmVkIiwiaXNDbGlja2VkIiwicmVtb3ZlRWRnZXMiLCJzcGxpY2UiLCJpc0NvbGxpc2lvbiIsInYiLCJoZWFkIiwidGFpbCIsImluZGV4IiwiciIsInRoaXMiLCJkcmF3biIsImJlZ2luUGF0aCIsImdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiIsIm1vdmVUbyIsImxpbmVUbyIsInN0cm9rZVN0eWxlIiwic3Ryb2tlIiwic3RhcnRpbmdBbmdsZSIsImVuZEFuZ2xlIiwiUEkiLCJsaW5lV2lkdGgiLCJyZWdpb24iLCJhcmMiLCJmaWxsU3R5bGUiLCJmb250IiwidGV4dEFsaWduIiwiZmlsbFRleHQiLCJjbGVhclJlY3QiLCJpbl94IiwiaW5feSIsImNsaWNrZWQiLCJhcnIiLCJ0b3RhbE9mZnNldFgiLCJ0b3RhbE9mZnNldFkiLCJjdXJyZW50RWxlbWVudCIsIm9mZnNldExlZnQiLCJzY3JvbGxMZWZ0Iiwib2Zmc2V0VG9wIiwic2Nyb2xsVG9wIiwib2Zmc2V0UGFyZW50IiwicGFnZVgiLCJwYWdlWSIsImEiLCJiIiwiZmFjdG9yIiwicmVzdWx0IiwiYWJzIiwicG9zIiwib21pdCIsIkhUTUxDYW52YXNFbGVtZW50IiwicHJvdG90eXBlIiwiQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUNBQyxJQUNBQyxNQUNBQyxNQUNBQyxLQUNBQyxPQUNBQyxRQUNBQyxNQUNBQyxTQUNBQyxPQUVBQyxLQUFPLFVBQ1BDLElBQU0sVUFDTkMsTUFBUSxVQUVaLFNBQVNDLE9BQ0xiLFdBQWFjLFNBQVNDLGVBQWUsWUFDckNkLElBQU1ELFdBQVdnQixXQUFXLE1BQzVCVixRQUFVLEdBQ1ZDLE1BQVEsR0FDUkMsU0FBVyxHQUNYTixNQUE0QixJQUFwQmUsT0FBT0MsV0FDZmYsTUFBNkIsSUFBckJjLE9BQU9FLFlBQ2ZmLEtBQU9nQixLQUFLQyxJQUFJbEIsTUFBT0QsT0FDdkJHLE9BQVNELEtBQU8sR0FDaEJILElBQUlxQixPQUFPQyxNQUFTbkIsS0FDcEJILElBQUlxQixPQUFPRSxPQUFTcEIsS0FFcEJKLFdBQVd5QixpQkFBaUIsWUFBYyxTQUFTQyxHQUMvQ2pCLE9BQVNULFdBQVcyQixlQUFlQyxPQUNuQ3BCLFNBQVcsQ0FBQ0MsT0FBT29CLEVBQUdwQixPQUFPcUIsS0FDOUIsR0FHSDlCLFdBQVd5QixpQkFBaUIsVUFBWSxTQUFTQyxHQUk3QyxHQUhBekIsSUFBSThCLFFBQ0p0QixPQUFTVCxXQUFXMkIsZUFBZUMsT0FFbEIsSUFBYkYsRUFBR00sT0FBZUMsUUFBUXpCLFNBQVUsQ0FBQ0MsT0FBT29CLEVBQUlwQixPQUFPcUIsR0FBSSxRQUFXLENBSXRFSSxpQkFBaUJ6QixPQUFRSixRQUhYLEVBQ0gsV0FJVixHQUFlLEdBQVpxQixFQUFHTSxNQUFXLENBQ2xCLElBQUlHLEVBQUlD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ekIsS0FHakJ1QixHQUFnQkUsRUFBZUMsV0FBYUQsRUFBZUUsV0FDM0RILEdBQWdCQyxFQUFlRyxVQUFZSCxFQUFlSSxVQUV4REosRUFBaUJBLEVBQWVLLGVBS3RDLE1BQU8sQ0FBQ2pFLEVBSEVELEVBQU1tRSxNQUFRUixFQUdMekQsRUFGVEYsRUFBTW9FLE1BQVFSLEdBSzVCLFNBQVN2RCxRQUFRZ0UsRUFBR0MsRUFBR0MsR0FLbkIsSUFKQSxJQUFJL0YsRUFBT2dCLEtBQUtDLElBQUk0RSxFQUFFcEQsT0FBUXFELEVBQUVyRCxRQUM1QnVELEdBQVMsRUFHTHBELEVBQUksRUFBR0EsRUFBSTVDLEVBQU00QyxJQUdYbUQsRUFGSC9FLEtBQUtpRixJQUFJSixFQUFFakQsR0FBS2tELEVBQUVsRCxNQUdyQm9ELEdBQVMsR0FJakIsT0FBT0EsRUFHWCxTQUFTaEUsb0JBQW9Ca0UsRUFBSzNDLEVBQUc0QyxHQUdqQyxJQUZBLElBQUl4QyxFQUFJLEtBRUFmLEVBQUksRUFBR0EsRUFBSVcsRUFBRWQsT0FBUUcsSUFDekIsR0FBR1csRUFBRVgsR0FBR08sVUFBVStDLEVBQUksR0FBSUEsRUFBSSxLQUN2QjNDLEVBQUVYLElBQU11RCxFQUFLLENBQ1p4QyxFQUFJSixFQUFFWCxHQUNOLE1BS1osT0FBT2UsRUFHWHlDLGtCQUFrQkMsVUFBVTlFLGVBQWlCQSxlQUU3QytFLHlCQUF5QkQsVUFBVTFFLE1BQVEsV0FDdkM5QixJQUFJaUYsVUFBVSxFQUFFLEVBQUU5RSxLQUFLQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgaHRtbENhbnZhcztcbnZhciBjdHg7XG52YXIgd2luX2w7XG52YXIgd2luX2g7XG52YXIgc2l6ZTtcbnZhciByYWRpdXM7XG52YXIgdmVjdG9ycztcbnZhciBlZGdlcztcbnZhciBtb3VzZVBvcztcbnZhciBjb29yZHM7XG5cbnZhciBibHVlID0gXCIjNWE4ZGVkXCI7XG52YXIgcmVkID0gXCIjZDYxZDQ1XCI7XG52YXIgd2hpdGUgPSBcIiNmM2Y3ZjNcIjtcblxuZnVuY3Rpb24gbWFpbigpIHtcbiAgICBodG1sQ2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJteUNhbnZhc1wiKTtcbiAgICBjdHggPSBodG1sQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgdmVjdG9ycyA9IFtdO1xuICAgIGVkZ2VzID0gW107XG4gICAgbW91c2VQb3MgPSBbXTtcbiAgICB3aW5fbCA9IHdpbmRvdy5pbm5lcldpZHRoICogMC45NjtcbiAgICB3aW5faCA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuOTY7XG4gICAgc2l6ZSA9IE1hdGgubWluKHdpbl9oLCB3aW5fbCk7XG4gICAgcmFkaXVzID0gc2l6ZSAvIDcwO1xuICAgIGN0eC5jYW52YXMud2lkdGggID0gc2l6ZTtcbiAgICBjdHguY2FudmFzLmhlaWdodCA9IHNpemU7XG5cbiAgICBodG1sQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgIGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGNvb3JkcyA9IGh0bWxDYW52YXMucmVsTW91c2VDb29yZHMoZXZlbnQpO1xuICAgICAgICBtb3VzZVBvcyA9IFtjb29yZHMueCwgY29vcmRzLnldO1xuICAgIH0sIGZhbHNlKTtcblxuXG4gICAgaHRtbENhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAgZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgY3R4LmNsZWFyKCk7XG4gICAgICAgIGNvb3JkcyA9IGh0bWxDYW52YXMucmVsTW91c2VDb29yZHMoZXZlbnQpO1xuXG4gICAgICAgIGlmIChldi53aGljaCA9PT0gMSAmJiBpc0Nsb3NlKG1vdXNlUG9zLCBbY29vcmRzLnggLCBjb29yZHMueV0sIChyYWRpdXMpKSkge1xuICAgICAgICAgICAgdmFyIHJlbW92ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciB0ZW1wID0gbnVsbDtcblxuICAgICAgICAgICAgbm9kZUV2ZW50SGFuZGxlcihjb29yZHMsIHJhZGl1cywgcmVtb3ZlZCwgdGVtcCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihldi53aGljaCA9PSAxKXtcbiAgICAgICAgICAgIHZhciBoID0gZ2V0VmVjdG9yQnlQb3NpdGlvbihtb3VzZVBvcywgdmVjdG9ycywgbnVsbCk7XG4gICAgICAgICAgICB2YXIgdCA9IGdldFZlY3RvckJ5UG9zaXRpb24oW2Nvb3Jkcy54LCBjb29yZHMueV0sIHZlY3RvcnMsIGgpO1xuXG4gICAgICAgICAgICBpZihoICE9IG51bGwgJiYgdCAhPSBudWxsKXtcbiAgICAgICAgICAgICAgICBlZGdlcy5wdXNoKG5ldyBFZGdlKGgsIHQpKTtcbiAgICAgICAgICAgIH0gICAgXG4gICAgICAgIH1cblxuICAgICAgICBkcmF3Tm9kZXMoKTtcbiAgICAgICAgZHJhd0VkZ2VzKCk7XG5cbiAgICAgICAgbW91c2VQb3MgPSBbY29vcmRzLngsIGNvb3Jkcy55XTtcbiAgICB9LCBmYWxzZSk7XG5cblxuICAgIGh0bWxDYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBmdW5jdGlvbihldikge1xuICAgICAgICBzY3JvbGxFdmVudChldik7XG4gICAgfSwgZmFsc2UpO1xufVxuXG5mdW5jdGlvbiBzY3JvbGxFdmVudChldil7XG4gICAgdmFyIHNjcm9sbCA9IDA7XG4gICAgdmFyIHkgPSBldi5kZWx0YVk7XG5cbiAgICBpZih2ZWN0b3JzLmxlbmd0aCA+IDApe1xuICAgICAgICBpZiAoeSA8IDAgJiYgcmFkaXVzID49IChzaXplIC8gNjUpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImRvd25cIik7XG4gICAgICAgICAgICBzY3JvbGwgPSAtMjsgICBcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh5ID4gMCAmJiByYWRpdXMgPD0gKHNpemUgLyA2MCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXBcIik7XG4gICAgICAgICAgICBzY3JvbGwgPSAyOyAgIFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmFkaXVzICs9IHNjcm9sbDtcblxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2ZWN0b3JzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgdGVtcCA9IHZlY3RvcnNbaV07XG4gICAgICAgIHZlY3RvcnNbaV0uY2xlYXJSZWdpb24oKTtcbiAgICAgICAgdmVjdG9yc1tpXSA9IG5ldyBOb2RlKHRlbXAueCwgdGVtcC55LCByYWRpdXMsIHRlbXAuZmlsbCwgMSwgaSk7XG4gICAgICAgIHZlY3RvcnNbaV0uZHJhdygpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm9kZUV2ZW50SGFuZGxlcihjb29yZHMsIHJhZGl1cywgcmVtb3ZlZCwgdGVtcCl7XG5cbiAgICAvL1RoZSBjb25kaXRpb25zIGdvIGFzIGZvbGxvd3M6XG4gICAgLy8xKSBUaGUgY2lyY2xlIG11c3QgZml0IGluIHRoZSBjYW52YXMgKGxpbmVzIDQyLTQzKVxuICAgIC8vMikgVGhlIGNpcmNsZSBtdXN0IG5vdCBvdmVybGFwIChsaW5lcyA0NylcbiAgICAvLzMpIElmIHRoZSBjaXJjbGUgaXMgYWxyZWFkeSBwcmVzZW50IGRvIG5vdCBhZGQsIGJ1dCByZW1vdmVcblxuICAgIGlmKGNvb3Jkcy54ID4gcmFkaXVzICYmIGNvb3Jkcy54IDwgc2l6ZSAtIHJhZGl1cyl7XG4gICAgICAgIGlmKGNvb3Jkcy55ID4gcmFkaXVzICYmIGNvb3Jkcy55IDwgc2l6ZSAtIHJhZGl1cyl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2ZWN0b3JzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICB0ZW1wID0gdmVjdG9yc1tpXTtcbiAgICAgICAgICAgICAgICBpZih0ZW1wICE9IG51bGwgJiYgdGVtcC5pc0NsaWNrZWQoY29vcmRzLngsIGNvb3Jkcy55KSl7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAuY2xlYXJSZWdpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRWRnZXModmVjdG9yc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIHZlY3RvcnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHJlbW92ZWQgPT0gZmFsc2Upe1xuICAgICAgICAgICAgICAgIHRlbXAgPSBuZXcgTm9kZShjb29yZHMueCwgY29vcmRzLnksIHJhZGl1cywgd2hpdGUsIDEsIHZlY3RvcnMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgaWYoIXRlbXAuaXNDb2xsaXNpb24odmVjdG9ycykpe1xuICAgICAgICAgICAgICAgICAgICB2ZWN0b3JzLnB1c2godGVtcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICAgIFxufVxuXG5mdW5jdGlvbiBkcmF3RWRnZXMoKXtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgZWRnZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICBlZGdlc1tpXS5kcmF3KCk7XG4gICAgfSAgICBcbn1cblxuZnVuY3Rpb24gcmVtb3ZlRWRnZXModil7XG4gICAgdmFyIGhlYWQgPSBudWxsO1xuICAgIHZhciB0YWlsID0gbnVsbDtcbiAgICB2YXIgaSA9IGVkZ2VzLmxlbmd0aCAtIDE7XG4gICAgd2hpbGUoaSA+PSAwKXtcbiAgICAgICAgaGVhZCA9IGVkZ2VzW2ldLmhlYWQuaW5kZXg7XG4gICAgICAgIHRhaWwgPSBlZGdlc1tpXS50YWlsLmluZGV4O1xuICAgICAgICBpZihoZWFkID09IHYuaW5kZXggfHwgdGFpbCA9PSB2LmluZGV4KXtcbiAgICAgICAgICAgIGVkZ2VzLnNwbGljZShpLCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzYVwiKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaS0tO1xuICAgICAgICBcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYXdOb2Rlcygpe1xuICAgIFxuICAgIC8vcmVkcmF3IG5vZGVzIGFzIGZvbGxvd3NcbiAgICAvL2lmIHRoZSBoZWFkIHlvdXIgYmx1ZVxuICAgIC8vaWYgdGhlIHRhaWwgeW91ciByZWRcbiAgICAvL2Vsc2UgeW91ciBncmVlblxuXG4gICAgaWYodmVjdG9ycy5sZW5ndGggPiAwKXtcbiAgICAgICAgdGVtcCA9IHZlY3RvcnNbMF07XG4gICAgICAgIHRlbXAuY2xlYXJSZWdpb24oKTtcbiAgICAgICAgdmVjdG9yc1swXSA9IG5ldyBOb2RlKHRlbXAueCwgdGVtcC55LCB0ZW1wLnIsIGJsdWUsIDEsIDApO1xuICAgICAgICB2ZWN0b3JzWzBdLmRyYXcoKTtcbiAgICB9XG5cbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgdmVjdG9ycy5sZW5ndGggLSAxOyBpKyspe1xuICAgICAgICB0ZW1wID0gdmVjdG9yc1tpXTtcbiAgICAgICAgdmVjdG9yc1tpXS5jbGVhclJlZ2lvbigpO1xuICAgICAgICB2ZWN0b3JzW2ldID0gbmV3IE5vZGUodGVtcC54LCB0ZW1wLnksIHRlbXAuciwgd2hpdGUsIDEsIGkpO1xuICAgICAgICB2ZWN0b3JzW2ldLmRyYXcoKTtcbiAgICB9XG5cbiAgICBpZih2ZWN0b3JzLmxlbmd0aCA+IDEpe1xuICAgICAgICB0ZW1wID0gdmVjdG9yc1t2ZWN0b3JzLmxlbmd0aCAtIDFdO1xuICAgICAgICB0ZW1wLmNsZWFyUmVnaW9uKCk7XG4gICAgICAgIHZlY3RvcnNbdmVjdG9ycy5sZW5ndGggLSAxXSA9IG5ldyBOb2RlKHRlbXAueCwgdGVtcC55LCB0ZW1wLnIsIHJlZCwgMSwgdmVjdG9ycy5sZW5ndGggLSAxKTtcbiAgICAgICAgdmVjdG9yc1t2ZWN0b3JzLmxlbmd0aCAtIDFdLmRyYXcoKTtcbiAgICB9XG5cbiAgICByZXR1cm47XG59XG5cbmZ1bmN0aW9uIEVkZ2UoaGVhZCwgdGFpbCl7XG4gICAgdGhpcy5oZWFkID0gaGVhZDtcbiAgICB0aGlzLnRhaWwgPSB0YWlsO1xuICAgIHRoaXMuZHJhd24gPSBmYWxzZTtcblxuICAgIHRoaXMuZHJhdyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdkZXN0aW5hdGlvbi1vdmVyJztcbiAgICAgICAgY3R4Lm1vdmVUbyhoZWFkLngsIGhlYWQueSk7XG4gICAgICAgIGN0eC5saW5lVG8odGFpbC54LCB0YWlsLnkpO1xuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB3aGl0ZTtcbiAgICAgICAgY3R4LnN0cm9rZSgpO1xuICAgICAgICBjdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcbiAgICAgICAgdGhpcy5kcmF3biA9IHRydWU7XG4gICAgfVxuXG4gICAgdGhpcy5kcmF3KCk7XG59XG5cbmZ1bmN0aW9uIE5vZGUoeCwgeSwgciwgZmlsbCwgc3Ryb2tlLCBpbmRleCkge1xuICAgIHRoaXMuc3RhcnRpbmdBbmdsZSA9IDA7XG4gICAgdGhpcy5lbmRBbmdsZSA9IDIgKiBNYXRoLlBJO1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnIgPSByO1xuICAgIHRoaXMubGluZVdpZHRoID0gNDtcbiAgICB0aGlzLnJlZ2lvbiA9ICgoc2l6ZSAvIDYwKSAqIDIuMikgKyB0aGlzLmxpbmVXaWR0aDtcbiAgICBcbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgdGhpcy5maWxsID0gZmlsbDtcbiAgICB0aGlzLnN0cm9rZSA9IHN0cm9rZTtcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSB3aGl0ZTtcblxuXG4gICAgdGhpcy5kcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGN0eC5hcmModGhpcy54LCB0aGlzLnksIHRoaXMuciwgdGhpcy5zdGFydGluZ0FuZ2xlLCB0aGlzLmVuZEFuZ2xlKTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuZmlsbDtcbiAgICAgICAgY3R4LmxpbmVXaWR0aCA9IHRoaXMubGluZVdpZHRoIC0gMTtcbiAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5zdHJva2U7XG4gICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgaWYociA+PSBzaXplIC8gNjApe1xuICAgICAgICAgICAgY3R4LmZvbnQgPSAnMTJwdCBHaWxsIFNhbnMnO1xuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICdibGFjayc7XG4gICAgICAgICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICAgICAgICBjdHguZmlsbFRleHQoaW5kZXgsIHRoaXMueCwgdGhpcy55KzMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhclJlZ2lvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjdHguY2xlYXJSZWN0KHRoaXMueCAtICh0aGlzLnJlZ2lvbiAvIDIpLCB0aGlzLnkgLSAodGhpcy5yZWdpb24gLyAyKSwgdGhpcy5yZWdpb24sIHRoaXMucmVnaW9uKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzQ2xpY2tlZCA9IGZ1bmN0aW9uIChpbl94LCBpbl95KSB7XG4gICAgICAgIHZhciBjbGlja2VkID0gZmFsc2U7XG5cbiAgICAgICAgaWYoaW5feCA+ICh4IC0gcikgJiYgaW5feCA8ICh4ICsgcikpe1xuICAgICAgICAgICAgaWYoaW5feSA+ICh5IC0gcikgJiYgaW5feSA8ICh5ICsgcikpe1xuICAgICAgICAgICAgICAgIGNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNsaWNrZWQ7XG4gICAgfVxuXG4gICAgdGhpcy5pc0NvbGxpc2lvbiA9IGZ1bmN0aW9uKGFycil7XG4gICAgICAgIHZhciBjbGlja2VkID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmKGFycltpXSAhPSBudWxsKXtcbiAgICAgICAgICAgICAgICB2YXIgaW5feCA9IGFycltpXS54O1xuICAgICAgICAgICAgICAgIHZhciBpbl95ID0gYXJyW2ldLnk7XG5cbiAgICAgICAgICAgICAgICBpZihpbl94ID4gKHggLSB0aGlzLnJlZ2lvbikgJiYgaW5feCA8ICh4ICsgdGhpcy5yZWdpb24pKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5feSA+ICh5IC0gdGhpcy5yZWdpb24pICYmIGluX3kgPCAoeSArIHRoaXMucmVnaW9uKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGlja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGlja2VkO1xuXG4gICAgfVxufVxuXG5mdW5jdGlvbiByZWxNb3VzZUNvb3JkcyhldmVudCl7XG4gICAgdmFyIHRvdGFsT2Zmc2V0WCA9IDA7XG4gICAgdmFyIHRvdGFsT2Zmc2V0WSA9IDA7XG4gICAgdmFyIGNhbnZhc1ggPSAwO1xuICAgIHZhciBjYW52YXNZID0gMDtcbiAgICB2YXIgY3VycmVudEVsZW1lbnQgPSB0aGlzO1xuXG4gICAgZG97XG4gICAgICAgIHRvdGFsT2Zmc2V0WCArPSBjdXJyZW50RWxlbWVudC5vZmZzZXRMZWZ0IC0gY3VycmVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICAgICAgdG90YWxPZmZzZXRZICs9IGN1cnJlbnRFbGVtZW50Lm9mZnNldFRvcCAtIGN1cnJlbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICB9XG4gICAgd2hpbGUoY3VycmVudEVsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5vZmZzZXRQYXJlbnQpXG5cbiAgICBjYW52YXNYID0gZXZlbnQucGFnZVggLSB0b3RhbE9mZnNldFg7XG4gICAgY2FudmFzWSA9IGV2ZW50LnBhZ2VZIC0gdG90YWxPZmZzZXRZO1xuXG4gICAgcmV0dXJuIHt4OmNhbnZhc1gsIHk6Y2FudmFzWX1cbn1cblxuZnVuY3Rpb24gaXNDbG9zZShhLCBiLCBmYWN0b3Ipe1xuICAgIHZhciBzaXplID0gTWF0aC5taW4oYS5sZW5ndGgsIGIubGVuZ3RoKTtcbiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgICB2YXIgZGlmZiA9IDA7IFxuXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKyl7XG4gICAgICAgIGRpZmYgPSBNYXRoLmFicyhhW2ldIC0gYltpXSk7XG4gICAgICAgIFxuICAgICAgICBpZihkaWZmID4gZmFjdG9yKXtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZ2V0VmVjdG9yQnlQb3NpdGlvbihwb3MsIHYsIG9taXQpe1xuICAgIHZhciByID0gbnVsbDtcblxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCB2Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgaWYodltpXS5pc0NsaWNrZWQocG9zWzBdLCBwb3NbMV0pKXtcbiAgICAgICAgICAgIGlmKHZbaV0gIT0gb21pdCl7XG4gICAgICAgICAgICAgICAgciA9IHZbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcjtcbn1cblxuSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLnJlbE1vdXNlQ29vcmRzID0gcmVsTW91c2VDb29yZHM7XG5cbkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpe1xuICAgIGN0eC5jbGVhclJlY3QoMCwwLHNpemUsc2l6ZSk7XG59Il19
